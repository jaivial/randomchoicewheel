const y="modulepreload",b=function(g,e){return new URL(g,e).href},m={},c=function(e,t,a){let n=Promise.resolve();if(t&&t.length>0){const i=document.getElementsByTagName("link"),s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=b(l,a),l in m)return;m[l]=!0;const d=l.endsWith(".css"),L=d?'[rel="stylesheet"]':"";if(!!a)for(let h=i.length-1;h>=0;h--){const p=i[h];if(p.href===l&&(!d||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${l}"]${L}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":y,d||(u.as="script"),u.crossOrigin="",u.href=l,o&&u.setAttribute("nonce",o),document.head.appendChild(u),d)return new Promise((h,p)=>{u.addEventListener("load",h),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function r(i){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i}return n.then(i=>{for(const s of i||[])s.status==="rejected"&&r(s.reason);return e().catch(r)})},f=(g,e,t)=>{const a=g[e];return a?typeof a=="function"?a():Promise.resolve(a):new Promise((n,r)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(r.bind(null,new Error("Unknown variable dynamic import: "+e+(e.split("/").length!==t?". Note that variables only represent file names one level deep.":""))))})};class w{constructor(){this.supportedLanguages={en:{name:"English",nativeName:"English",flag:"🇺🇸",rtl:!1},es:{name:"Spanish",nativeName:"Español",flag:"🇪🇸",rtl:!1},fr:{name:"French",nativeName:"Français",flag:"🇫🇷",rtl:!1}},this.defaultLanguage="en",this.currentLanguage=null,this.translations={},this.changeListeners=[],this.storageKeys={language:"wheel_spinner_language",autoDetected:"wheel_spinner_auto_detected"},this.initialize()}async initialize(){try{const e=this.detectInitialLanguage();await this.loadTranslations(e),this.setLanguage(e,!1),console.log(`Language Manager initialized with language: ${e}`)}catch(e){console.error("Error initializing Language Manager:",e),await this.loadTranslations(this.defaultLanguage),this.setLanguage(this.defaultLanguage,!1)}}detectInitialLanguage(){const e=localStorage.getItem(this.storageKeys.language);if(e&&this.isLanguageSupported(e))return console.log(`Using saved language preference: ${e}`),e;const t=this.detectBrowserLanguage();return t&&this.isLanguageSupported(t)?(console.log(`Auto-detected browser language: ${t}`),localStorage.setItem(this.storageKeys.autoDetected,"true"),t):(console.log(`Falling back to default language: ${this.defaultLanguage}`),this.defaultLanguage)}detectBrowserLanguage(){var t;const e=[navigator.language,(t=navigator.languages)==null?void 0:t[0],navigator.userLanguage,navigator.browserLanguage,navigator.systemLanguage].filter(Boolean);for(const a of e){const n=a.toLowerCase().split("-")[0];if(this.isLanguageSupported(n))return n}return null}isLanguageSupported(e){return e&&this.supportedLanguages.hasOwnProperty(e)}async loadTranslations(e){if(!this.isLanguageSupported(e))throw new Error(`Unsupported language: ${e}`);try{const t=await f(Object.assign({"./translations/en.js":()=>c(()=>import("./translations-xJY1-IwQ.js").then(a=>a.e),[],import.meta.url),"./translations/es.js":()=>c(()=>import("./translations-xJY1-IwQ.js").then(a=>a.a),[],import.meta.url),"./translations/fr.js":()=>c(()=>import("./translations-xJY1-IwQ.js").then(a=>a.f),[],import.meta.url)}),`./translations/${e}.js`,3);this.translations[e]=t.default||t,console.log(`Loaded translations for language: ${e}`)}catch(t){if(console.error(`Failed to load translations for ${e}:`,t),e!==this.defaultLanguage){console.log(`Loading fallback translations for: ${this.defaultLanguage}`);const a=await f(Object.assign({"./translations/en.js":()=>c(()=>import("./translations-xJY1-IwQ.js").then(n=>n.e),[],import.meta.url),"./translations/es.js":()=>c(()=>import("./translations-xJY1-IwQ.js").then(n=>n.a),[],import.meta.url),"./translations/fr.js":()=>c(()=>import("./translations-xJY1-IwQ.js").then(n=>n.f),[],import.meta.url)}),`./translations/${this.defaultLanguage}.js`,3);this.translations[e]=a.default||a}else throw t}}async setLanguage(e,t=!0){if(!this.isLanguageSupported(e)){console.warn(`Attempted to set unsupported language: ${e}`);return}this.translations[e]||await this.loadTranslations(e);const a=this.currentLanguage;this.currentLanguage=e,t&&(localStorage.setItem(this.storageKeys.language,e),localStorage.removeItem(this.storageKeys.autoDetected)),document.documentElement.lang=e,this.notifyLanguageChange(e,a),console.log(`Language changed to: ${e}`)}t(e,t={}){if(!this.currentLanguage||!this.translations[this.currentLanguage])return console.warn("No translations loaded, returning key:",e),e;const a=e.split(".");let n=this.translations[this.currentLanguage];for(const r of a)if(n&&typeof n=="object"&&n.hasOwnProperty(r))n=n[r];else return this.getFallbackTranslation(e,t);return typeof n=="string"&&Object.keys(t).length>0?this.interpolateString(n,t):n||e}getFallbackTranslation(e,t={}){if(this.currentLanguage===this.defaultLanguage||!this.translations[this.defaultLanguage])return console.warn(`Translation not found for key: ${e}`),e;const a=e.split(".");let n=this.translations[this.defaultLanguage];for(const r of a)if(n&&typeof n=="object"&&n.hasOwnProperty(r))n=n[r];else return console.warn(`Fallback translation not found for key: ${e}`),e;return typeof n=="string"&&Object.keys(t).length>0?this.interpolateString(n,t):n||e}interpolateString(e,t){return e.replace(/\{\{(\w+)\}\}/g,(a,n)=>t.hasOwnProperty(n)?t[n]:a)}getCurrentLanguage(){return{code:this.currentLanguage,...this.supportedLanguages[this.currentLanguage]}}getSupportedLanguages(){return{...this.supportedLanguages}}addLanguageChangeListener(e){typeof e=="function"&&this.changeListeners.push(e)}removeLanguageChangeListener(e){const t=this.changeListeners.indexOf(e);t>-1&&this.changeListeners.splice(t,1)}notifyLanguageChange(e,t){this.changeListeners.forEach(a=>{try{a(e,t)}catch(n){console.error("Error in language change listener:",n)}})}isAutoDetected(){return localStorage.getItem(this.storageKeys.autoDetected)==="true"}resetLanguagePreference(){localStorage.removeItem(this.storageKeys.language),localStorage.removeItem(this.storageKeys.autoDetected)}getLanguageStats(){return{current:this.currentLanguage,supported:Object.keys(this.supportedLanguages),autoDetected:this.isAutoDetected(),browserLanguage:this.detectBrowserLanguage(),loadedTranslations:Object.keys(this.translations)}}}class E{constructor(e){this.languageManager=e,this.isModalOpen=!1,this.selectedLanguage=null,this.container=null,this.button=null,this.modal=null,this.modalOverlay=null,this.modalContent=null,this.currentFlag=null,this.currentLabel=null,this.autoDetectedBadge=null,this.eventListeners=[],this.initialize()}async initialize(){try{this.languageManager.currentLanguage||await this.waitForLanguageManager(),this.createUI(),this.setupEventListeners(),this.updateDisplay(),console.log("Language Selector (Modal) initialized successfully")}catch(e){console.error("Error initializing Language Selector:",e)}}waitForLanguageManager(){return new Promise(e=>{const t=()=>{const a=this.languageManager.getCurrentLanguage();this.languageManager.currentLanguage&&a&&a.code?(console.log("Language Manager is ready with language:",a.code),e()):(console.log("Waiting for Language Manager to be ready..."),setTimeout(t,50))};t()})}createUI(){this.container=document.createElement("div"),this.container.className="language-selector-container",this.createButton(),this.createModal(),this.insertIntoPage()}createButton(){this.button=document.createElement("button"),this.button.className="language-selector-button",this.button.setAttribute("type","button"),this.button.setAttribute("aria-label","Open language selector"),this.currentFlag=document.createElement("span"),this.currentFlag.className="language-flag",this.currentFlag.setAttribute("aria-hidden","true"),this.currentLabel=document.createElement("span"),this.currentLabel.className="language-label",this.autoDetectedBadge=document.createElement("span"),this.autoDetectedBadge.className="auto-detected-badge",this.autoDetectedBadge.textContent="Auto",this.autoDetectedBadge.setAttribute("title","Automatically detected"),this.button.appendChild(this.currentFlag),this.button.appendChild(this.currentLabel),this.button.appendChild(this.autoDetectedBadge),this.container.appendChild(this.button)}createModal(){this.modalOverlay=document.createElement("div"),this.modalOverlay.className="language-modal-overlay hidden",this.modalOverlay.setAttribute("aria-hidden","true"),this.modalContent=document.createElement("div"),this.modalContent.className="language-modal-content glass-card",this.modalContent.setAttribute("role","dialog"),this.modalContent.setAttribute("aria-labelledby","language-modal-title"),this.modalContent.setAttribute("aria-modal","true");const e=document.createElement("div");e.className="language-modal-header";const t=document.createElement("h2");t.id="language-modal-title",t.className="language-modal-title",t.textContent="Select Language";const a=document.createElement("button");a.className="language-modal-close",a.setAttribute("type","button"),a.setAttribute("aria-label","Close language selector"),a.innerHTML="✕",e.appendChild(t),e.appendChild(a);const n=document.createElement("div");n.className="language-modal-body";const r=this.languageManager.getSupportedLanguages();Object.entries(r).forEach(([i,s])=>{const o=this.createLanguageOption(i,s);n.appendChild(o)}),this.modalContent.appendChild(e),this.modalContent.appendChild(n),this.modalOverlay.appendChild(this.modalContent),document.body.appendChild(this.modalOverlay),this.closeButton=a}createLanguageOption(e,t){const a=document.createElement("button");a.className="language-option",a.setAttribute("type","button"),a.setAttribute("data-language",e),a.setAttribute("aria-label",`Select ${t.name}`);const n=document.createElement("span");n.className="language-flag",n.textContent=t.flag,n.setAttribute("aria-hidden","true");const r=document.createElement("div");r.className="language-info";const i=document.createElement("span");i.className="language-native-name",i.textContent=t.nativeName;const s=document.createElement("span");s.className="language-english-name",s.textContent=t.name,r.appendChild(i),r.appendChild(s);const o=document.createElement("span");return o.className="language-selected-indicator",o.innerHTML="✓",o.setAttribute("aria-hidden","true"),a.appendChild(n),a.appendChild(r),a.appendChild(o),a}insertIntoPage(){const e=document.querySelector("header");if(e){let t=document.querySelector(".header-language-wrapper");t||(t=document.createElement("div"),t.className="header-language-wrapper",e.appendChild(t)),t.appendChild(this.container)}else document.body.appendChild(this.container)}setupEventListeners(){const e=s=>{s.preventDefault(),s.stopPropagation(),this.openModal()};this.button.addEventListener("click",e),this.eventListeners.push({element:this.button,event:"click",handler:e});const t=s=>{s.preventDefault(),s.stopPropagation(),this.closeModal()};this.closeButton.addEventListener("click",t),this.eventListeners.push({element:this.closeButton,event:"click",handler:t});const a=s=>{s.preventDefault(),s.stopPropagation();const o=s.currentTarget.getAttribute("data-language");o&&this.selectLanguage(o)};this.modalContent.querySelectorAll(".language-option").forEach(s=>{s.addEventListener("click",a),this.eventListeners.push({element:s,event:"click",handler:a})});const n=s=>{s.target===this.modalOverlay&&this.closeModal()};this.modalOverlay.addEventListener("click",n),this.eventListeners.push({element:this.modalOverlay,event:"click",handler:n});const r=s=>{this.handleKeyboardNavigation(s)};document.addEventListener("keydown",r),this.eventListeners.push({element:document,event:"keydown",handler:r});const i=s=>{this.updateDisplay()};this.languageManager.addLanguageChangeListener(i),this.eventListeners.push({element:this.languageManager,event:"languageChange",handler:i})}handleKeyboardNavigation(e){if(this.isModalOpen)switch(e.key){case"Escape":e.preventDefault(),this.closeModal();break;case"Tab":this.trapFocus(e);break}}trapFocus(e){const t=this.modalContent.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),a=t[0],n=t[t.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),n.focus()):document.activeElement===n&&(e.preventDefault(),a.focus())}openModal(){this.isModalOpen=!0,this.modalOverlay.classList.remove("hidden"),this.modalOverlay.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",setTimeout(()=>{const e=this.modalContent.querySelector(".language-option");e&&e.focus()},100)}closeModal(){this.isModalOpen=!1,this.modalOverlay.classList.add("hidden"),this.modalOverlay.setAttribute("aria-hidden","true"),document.body.style.overflow="",this.button.focus()}async selectLanguage(e){try{await this.languageManager.setLanguage(e,!0),this.closeModal(),console.log(`Language selected: ${e}`)}catch(t){console.error("Error selecting language:",t)}}updateDisplay(){const e=this.languageManager.getCurrentLanguage(),t=this.languageManager.getSupportedLanguages();if(console.log("LanguageSelector updateDisplay:",{currentLang:e,currentLanguageCode:e==null?void 0:e.code,managerCurrentLanguage:this.languageManager.currentLanguage}),e&&e.code&&t[e.code]){const a=t[e.code];this.currentFlag.textContent=a.flag,this.currentLabel.textContent=a.nativeName,this.languageManager.isAutoDetected()?this.autoDetectedBadge.classList.remove("hidden"):this.autoDetectedBadge.classList.add("hidden"),this.updateSelectedOption(e.code),this.button.setAttribute("aria-label",`Current language: ${a.name}. Click to change language.`);const n=this.modalContent.querySelector(".language-modal-title");n&&this.languageManager.t&&(n.textContent=this.languageManager.t("language.selectorTitle")||"Select Language")}else console.warn("Language info not available, using fallback display"),this.currentFlag.textContent="🌐",this.currentLabel.textContent="Loading...",this.autoDetectedBadge.classList.add("hidden"),this.updateSelectedOption(null)}updateSelectedOption(e){if(this.modalContent.querySelectorAll(".language-option").forEach(t=>{t.classList.remove("selected")}),e){const t=this.modalContent.querySelector(`[data-language="${e}"]`);t&&t.classList.add("selected")}}getState(){return{isModalOpen:this.isModalOpen,currentLanguage:this.languageManager.currentLanguage,isAutoDetected:this.languageManager.isAutoDetected(),supportedLanguages:Object.keys(this.languageManager.getSupportedLanguages())}}cleanup(){this.eventListeners.forEach(({element:e,event:t,handler:a})=>{e===this.languageManager?e.removeLanguageChangeListener(a):e.removeEventListener(t,a)}),this.container&&this.container.parentNode&&this.container.parentNode.removeChild(this.container),this.modalOverlay&&this.modalOverlay.parentNode&&this.modalOverlay.parentNode.removeChild(this.modalOverlay),this.isModalOpen&&(document.body.style.overflow=""),console.log("Language Selector (Modal) cleaned up")}}class S{constructor(e){this.languageManager=e,this.baseUrl="https://wheelspinner.app",this.defaultConfig={siteName:"Decision Wheel Spinner",appName:"Decision Wheel Spinner",twitterHandle:"@wheelspinner",themeColor:"#667eea",locale:{en:"en_US",es:"es_ES",fr:"fr_FR"}},this.elements={title:null,description:null,keywords:null,language:null,htmlLang:null,structuredData:null},this.initialize()}initialize(){try{this.cacheElements(),this.languageManager.addLanguageChangeListener((e,t)=>{this.updateSEOForLanguage(e)}),this.languageManager.currentLanguage&&this.updateSEOForLanguage(this.languageManager.currentLanguage),console.log("SEO Manager initialized successfully")}catch(e){console.error("Error initializing SEO Manager:",e)}}cacheElements(){this.elements.title=document.querySelector("title"),this.elements.description=document.querySelector('meta[name="description"]'),this.elements.keywords=document.querySelector('meta[name="keywords"]'),this.elements.language=document.querySelector('meta[name="language"]'),this.elements.htmlLang=document.documentElement,this.elements.structuredData=document.querySelector("#structured-data"),this.elements.ogTitle=document.querySelector('meta[property="og:title"]'),this.elements.ogDescription=document.querySelector('meta[property="og:description"]'),this.elements.ogUrl=document.querySelector('meta[property="og:url"]'),this.elements.ogLocale=document.querySelector('meta[property="og:locale"]'),this.elements.twitterTitle=document.querySelector('meta[name="twitter:title"]'),this.elements.twitterDescription=document.querySelector('meta[name="twitter:description"]')}updateSEOForLanguage(e){try{const t=this.getMetaTranslations(e);if(!t){console.warn(`No meta translations found for language: ${e}`);return}this.updateBasicMetaTags(t,e),this.updateOpenGraphTags(t,e),this.updateTwitterCardTags(t,e),this.updateStructuredData(t,e),this.updateAlternateLinks(e),this.updateUrlParameters(e),console.log(`SEO updated for language: ${e}`)}catch(t){console.error(`Error updating SEO for language ${e}:`,t)}}getMetaTranslations(e){return this.languageManager.translations[e]&&this.languageManager.translations[e].meta||null}updateBasicMetaTags(e,t){this.elements.title&&e.title&&(this.elements.title.textContent=e.title),this.elements.description&&e.description&&this.elements.description.setAttribute("content",e.description),this.elements.keywords&&e.keywords&&this.elements.keywords.setAttribute("content",e.keywords),this.elements.language&&this.elements.language.setAttribute("content",t),this.elements.htmlLang&&this.elements.htmlLang.setAttribute("lang",t)}updateOpenGraphTags(e,t){if(this.elements.ogTitle&&e.ogTitle&&this.elements.ogTitle.setAttribute("content",e.ogTitle),this.elements.ogDescription&&e.ogDescription&&this.elements.ogDescription.setAttribute("content",e.ogDescription),this.elements.ogUrl){const a=`${this.baseUrl}/${t}`;this.elements.ogUrl.setAttribute("content",a)}this.elements.ogLocale&&this.defaultConfig.locale[t]&&this.elements.ogLocale.setAttribute("content",this.defaultConfig.locale[t])}updateTwitterCardTags(e,t){this.elements.twitterTitle&&e.twitterTitle&&this.elements.twitterTitle.setAttribute("content",e.twitterTitle),this.elements.twitterDescription&&e.twitterDescription&&this.elements.twitterDescription.setAttribute("content",e.twitterDescription)}updateStructuredData(e,t){if(this.elements.structuredData)try{const a=JSON.parse(this.elements.structuredData.textContent),n={...a,name:e.title||a.name,description:e.description||a.description,url:`${this.baseUrl}/${t}`,inLanguage:t,availableLanguage:[{"@type":"Language",name:"English",alternateName:"en"},{"@type":"Language",name:"Spanish",alternateName:"es"},{"@type":"Language",name:"French",alternateName:"fr"}]};this.elements.structuredData.textContent=JSON.stringify(n,null,2)}catch(a){console.error("Error updating structured data:",a)}}updateAlternateLinks(e){document.querySelectorAll("link[hreflang]").forEach(i=>i.remove());const a=this.languageManager.getSupportedLanguages(),n=document.head;Object.keys(a).forEach(i=>{const s=document.createElement("link");s.rel="alternate",s.hreflang=i,s.href=`${this.baseUrl}/${i}`,n.appendChild(s)});const r=document.createElement("link");r.rel="alternate",r.hreflang="x-default",r.href=`${this.baseUrl}/`,n.appendChild(r)}updateUrlParameters(e){const t=new URL(window.location);if((!t.searchParams.get("lang")||t.searchParams.get("lang")!==e)&&window.history&&window.history.replaceState){const n=new URL(window.location);n.searchParams.set("lang",e),window.history.replaceState(null,"",n.toString())}}getSEOState(){var e,t,a,n,r,i,s,o;return{currentLanguage:this.languageManager.currentLanguage,baseUrl:this.baseUrl,title:(e=this.elements.title)==null?void 0:e.textContent,description:(t=this.elements.description)==null?void 0:t.getAttribute("content"),keywords:(a=this.elements.keywords)==null?void 0:a.getAttribute("content"),ogTitle:(n=this.elements.ogTitle)==null?void 0:n.getAttribute("content"),ogDescription:(r=this.elements.ogDescription)==null?void 0:r.getAttribute("content"),ogUrl:(i=this.elements.ogUrl)==null?void 0:i.getAttribute("content"),twitterTitle:(s=this.elements.twitterTitle)==null?void 0:s.getAttribute("content"),twitterDescription:(o=this.elements.twitterDescription)==null?void 0:o.getAttribute("content")}}forceSEOUpdate(e){this.languageManager.isLanguageSupported(e)?(this.updateSEOForLanguage(e),console.log(`Forced SEO update for language: ${e}`)):console.warn(`Cannot force SEO update for unsupported language: ${e}`)}updateBaseUrl(e){this.baseUrl=e.replace(/\/$/,""),this.languageManager.currentLanguage&&this.updateSEOForLanguage(this.languageManager.currentLanguage),console.log(`Base URL updated to: ${this.baseUrl}`)}getCanonicalUrl(){const e=this.languageManager.currentLanguage||"en";return`${this.baseUrl}/${e}`}ensureCanonicalLink(){let e=document.querySelector('link[rel="canonical"]');e||(e=document.createElement("link"),e.rel="canonical",document.head.appendChild(e)),e.href=this.getCanonicalUrl()}cleanup(){this.languageManager&&this.languageManager.removeLanguageChangeListener&&console.log("SEO Manager cleanup completed")}}export{w as L,S,E as a};
